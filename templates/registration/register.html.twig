{% extends 'base.html.twig' %}

{% block title %}Inscription{% endblock %}

{% block body %}
    <div style="max-width: 500px; margin: 50px auto; padding: 20px; border: 1px solid #ddd; border-radius: 5px;">
        <h1>Inscription</h1>

        {# Affichage des messages flash #}
        {% for label, messages in app.flashes %}
            {% for message in messages %}
                <div class="alert alert-{{ label }}"
                     style="
                             padding: 10px;
                             margin-bottom: 15px;
                             border-radius: 3px;
                             {% if label == 'success' %}background-color: #d4edda; color: #155724; border: 1px solid #c3e6cb;
                     {% elseif label == 'warning' %}background-color: #fff3cd; color: #856404; border: 1px solid #ffeeba;
                     {% elseif label == 'danger' or label == 'error' %}background-color: #f8d7da; color: #721c24; border: 1px solid #f5c6cb;
                     {% endif %}">
                    {{ message }}
                </div>
            {% endfor %}
        {% endfor %}

        {# Affichage des erreurs du formulaire en haut #}
        {% if not registrationForm.vars.valid %}
            <div class="alert alert-danger"
                 style="padding: 10px; margin-bottom: 15px; border-radius: 3px; background-color: #f8d7da; color: #721c24; border: 1px solid #f5c6cb;">
                <ul style="margin: 0; padding-left: 20px;">
                    {% for child in registrationForm.children %}
                        {% if not child.vars.valid %}
                            {% for error in child.vars.errors %}
                                <li>{{ error.message }}</li>
                            {% endfor %}
                        {% endif %}
                        {% if child.children is defined and child.children|length > 0 %}
                            {% for subChild in child.children %}
                                {% if not subChild.vars.valid %}
                                    {% for error in subChild.vars.errors %}
                                        <li>{{ error.message }}</li>
                                    {% endfor %}
                                {% endif %}
                            {% endfor %}
                        {% endif %}
                    {% endfor %}
                </ul>
            </div>
        {% endif %}

        {{ form_start(registrationForm) }}
        <div style="margin-bottom: 15px;">
            {{ form_label(registrationForm.nom) }}
            {{ form_widget(registrationForm.nom, {'attr': {'style': 'width: 100%; padding: 8px; margin-top: 5px;'}}) }}
        </div>

        <div style="margin-bottom: 15px;">
            {{ form_label(registrationForm.prenom) }}
            {{ form_widget(registrationForm.prenom, {'attr': {'style': 'width: 100%; padding: 8px; margin-top: 5px;'}}) }}
        </div>

        <div style="margin-bottom: 15px;">
            {{ form_label(registrationForm.email) }}
            {{ form_widget(registrationForm.email, {'attr': {'style': 'width: 100%; padding: 8px; margin-top: 5px;'}}) }}
        </div>

        <div style="margin-bottom: 15px;">
            {{ form_label(registrationForm.zoneIntervention, 'Zone d\'intervention') }}
            {{ form_widget(registrationForm.zoneIntervention, {'attr': {'style': 'width: 100%; padding: 8px; margin-top: 5px;'}}) }}
        </div>

        <div style="margin-bottom: 15px;">
            {{ form_label(registrationForm.plainPassword.first) }}
            {{ form_widget(registrationForm.plainPassword.first, {'attr': {'style': 'width: 100%; padding: 8px; margin-top: 5px;'}}) }}
        </div>

        <div style="margin-bottom: 15px;">
            {{ form_label(registrationForm.plainPassword.second) }}
            {{ form_widget(registrationForm.plainPassword.second, {'attr': {'style': 'width: 100%; padding: 8px; margin-top: 5px;'}}) }}
        </div>

        <div style="margin-bottom: 15px;">
            {{ form_widget(registrationForm.agreeTerms) }}
            {{ form_label(registrationForm.agreeTerms, 'J\'accepte les conditions d\'utilisation') }}
        </div>

        <button type="submit" style="background: #0275d8; color: white; padding: 10px 15px; border: none; border-radius: 3px; cursor: pointer;">
            S'inscrire
        </button>
        {{ form_end(registrationForm) }}

        <p style="margin-top: 20px; text-align: center;">
            Déjà inscrit? <a href="{{ path('app_login') }}" style="color: #0275d8; text-decoration: none;">Se connecter</a>
        </p>
    </div>
{% endblock %}